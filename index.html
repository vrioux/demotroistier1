<html>
    <head>
        <script type="text/javascript">
        function addEntry() {
            var xhr = new XMLHttpRequest();
            var url = document.getElementById('url').value;
            xhr.open("POST", url, true);
            xhr.send(JSON.stringify({
                value: '1'
            }));
        }
        function getEntries() {
            var xhr = new XMLHttpRequest();
            var url = document.getElementById('url').value;
            xhr.onreadystatechange = function () {
                if (this.readyState != 4) return;
                if (this.status == 200) {
                    var data = JSON.parse(this.responseText);
                    console.log(data);
                    document.getElementById('numberOfEntries').innerText = data;
                }
            };

            xhr.open('GET', url, true);
            xhr.send();
        }
        </script>
    </head>
    <body>
        <h1>Lunch and learn</h1>
        <p>URL de l'API:</p>
        <input type="text" value="http://127.0.0.1" id="url" style="width:500px"/>
        <p>Cliquez sur le bouton ci-dessous pour ajouter une entr&eacute;e dans la BD.</p>
        <p>Le compteur de nombre d'entr&eacute;es se met &agrave; jour &agrave; chaque seconde.</p>
        <p>Nombre d'entr&eacute;es dans la BD: <span id="numberOfEntries"></span></p>
        <button id="add" onclick="addEntry()">Ajouter une entr&eacute;e</button>
        
        <script type="text/javascript">
            var apihost = '<apihost>';
            if (apihost.indexOf('apihost') == -1) {
                document.getElementById('url').value = 'http://' + apihost + '/index.php';
            } else {
                document.getElementById('url').value = window.location.href + 'index.php';
            }
            window.setInterval(getEntries, 1000);
        </script>
    </body>
</html>